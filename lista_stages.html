<html>

<head>
    <link rel="stylesheet" href="lista_stages.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
    <link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet" />

    <script src="https://unpkg.com/dexie@latest/dist/dexie.js"></script>

    <script type="text/javascript" src="lista_stages.js"></script>
    <script src="./db.js"></script>

    <script>

    </script>
</head>

<body>
    <div class="container">
        <label for="combo_edicion">Choose a Stage:</label>
        <table id="combo_edicion"></table>
    </div>
    <script>
        db_get_stages().then(function (registros) {
            //console.log('nombres', registros);
            var lista_stages = Array();
            if (registros.length === 0) {
                console.log("No hay bases de datos");
            } else {
                for (var i = 0; i < registros.length; i++) {
                    //html += '<tr><td class="opciones" onclick="carga_tour(this);">' + registros[i].nombre_etapa + '</td></tr>';
                    console.log('stage: ', registros[i].nombre_etapa);
                    if (!lista_stages.includes(registros[i].nombre_etapa)) {
                        lista_stages.push(registros[i].nombre_etapa);
                    }
                }

                select = document.getElementById('combo_edicion');
                var html = '';
                for (var i = 0; i < lista_stages.length; i++) {
                    html += '<tr><td class="opciones" onclick="carga_stage(this);">' + lista_stages[i] + '</td></tr>';
                }
                select.innerHTML = html;
            }
        });
    </script>
</body>